package com.example.riderapp;import java.util.ArrayList;import java.util.List;import com.example.riderapp.model.Artical;import com.example.riderapp.uiutils.LoadMoreListView;import com.example.riderapp.uiutils.PullAndLoadListView;import com.example.riderapp.uiutils.PullAndLoadListView.OnLoadMoreListener;import com.example.riderapp.uiutils.PullToRefreshListView.OnRefreshListener;import android.annotation.SuppressLint;import android.app.Activity;import android.content.Context;import android.content.Intent;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.ListFragment;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ArrayAdapter;import android.widget.BaseAdapter;import android.widget.ListView;import android.widget.TextView;import android.widget.Toast;public class ArticalPage extends ListFragment {	private List<Artical> articals;	private MainActivityCallBacks callback;	@Override	public View onCreateView(LayoutInflater inflater, ViewGroup container,			Bundle savedInstanceState) {		ViewGroup view = (ViewGroup) inflater.inflate(R.layout.arctical_layout,				container, false);		// Set a listener to be invoked when the list should be refreshed.		((PullAndLoadListView) view.findViewById(android.R.id.list))				.setOnRefreshListener(new OnRefreshListener() {					@Override					public void onRefresh() {						Artical a = new Artical();						a.setTitle("清远一日游" + System.currentTimeMillis());						a.setFromWhere("广州");						a.setToWhere("清远清新");						a.setLeader("晓晓棚");						articals.add(0, a);						((BaseAdapter) getListAdapter()).notifyDataSetChanged();						((PullAndLoadListView) getListView())								.onRefreshComplete();					}				});		// set a listener to be invoked when the list reaches the end		((PullAndLoadListView) view.findViewById(android.R.id.list))				.setOnLoadMoreListener(new OnLoadMoreListener() {					@Override					public void onLoadMore() {						// Artical a = new Artical();						// a.setTitle("清远一日游" + System.currentTimeMillis());						// a.setFromWhere("广州");						// a.setToWhere("清远清新");						// a.setLeader("晓晓棚");						// articals.add(a);						((BaseAdapter) getListAdapter()).notifyDataSetChanged();						((PullAndLoadListView) getListView())								.onLoadMoreComplete();					}				});		// ((LoadMoreListView) view.findViewById(android.R.id.list))		// .setOnLoadMoreListener(new OnLoadMoreListener() {		// public void onLoadMore() {		// // Do the work to load more items at the end of list		// // here		// // We need notify the adapter that the data have been		// // changed		// // Artical a = new Artical();		// // a.setTitle("清远一日游"+System.currentTimeMillis());		// // a.setFromWhere("广州");		// // a.setToWhere("清远清新");		// // a.setLeader("晓晓棚");		// // articals.add(a);		//		// // ((BaseAdapter)		// // getListAdapter()).notifyDataSetChanged();		// ((BaseAdapter) getListAdapter()).notifyDataSetChanged();		//		// // Call onLoadMoreComplete when the LoadMore task, has		// // finished		// ((LoadMoreListView) getListView()).onLoadMoreComplete();		// }		// });		return view;	}	@Override	public void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		articals = new ArrayList<>();		Artical a = new Artical();		a.setTitle("清远一日游");		a.setFromWhere("广州");		a.setToWhere("清远清新");		a.setLeader("晓晓棚");		articals.add(a);		articals.add(a);			ArticalsAdapter adapter = new ArticalsAdapter(getActivity(),				R.layout.artical_item_layout, articals);		setListAdapter(adapter);	}	@Override	public void onListItemClick(ListView l, View v, int position, long id) {		// TODO Auto-generated method stub		callback.onArticalSelected(articals.get(position-1));	}	@Override	public void onAttach(Activity activity) {		super.onAttach(activity);		this.callback = (MainActivityCallBacks) activity;	}	@Override	public void onActivityCreated(@Nullable Bundle savedInstanceState) {		super.onActivityCreated(savedInstanceState);	}}class ArticalsAdapter extends ArrayAdapter<Artical> {	private Context context;	private List<Artical> objects;	public ArticalsAdapter(Context context, int resource, List<Artical> objects) {		super(context, resource, objects);		this.context = context;		this.objects = objects;	}	@Override	public View getView(int position, View convertView, ViewGroup parent) {		// TODO Auto-generated method stub		Artical artical = objects.get(position);		LayoutInflater inflater = (LayoutInflater) context				.getSystemService(Activity.LAYOUT_INFLATER_SERVICE);		View view = inflater.inflate(R.layout.artical_item_layout, null);		TextView arti_title = (TextView) view.findViewById(R.id.artical_title);		TextView from_where = (TextView) view.findViewById(R.id.from_where);		TextView to_where = (TextView) view.findViewById(R.id.to_where);		TextView leader = (TextView) view.findViewById(R.id.leader);		from_where.setText(artical.getFromWhere());		to_where.setText(artical.getToWhere());		leader.setText(artical.getLeader());		arti_title.setText(artical.getTitle());		return view;	}}